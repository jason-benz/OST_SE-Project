@page "/movieDetailView/{Id:int}"

<PageTitle>Media Details</PageTitle>
@using MediaHub.Services
@using MediaHub.Data.Model
@using Microsoft.AspNetCore.Routing.Matching
@inject MediaService MediaServiceInstance 

@if (movie != null)
{
<div class="detaile-view-container">
    <div class="title-and-add-button">
        <h1>@movie.Title</h1>
            @if (isInFavorites)
            {
                <button class="btn btn-primary" @onclick="SwitchFavorites"><span class="oi oi-minus" aria-hidden="true"></span> Remove from favorites</button>
            } else
            {
                <button class="btn btn-primary" @onclick="SwitchFavorites"><span class="oi oi-plus" aria-hidden="true"></span> Add to favorites</button>
            }
    </div>
    <img width="100px" src="@movie.PosterUrl">
    <table class="media-data-table">
        <tbody>
            <tr>
                <td class="caption">Year:</td>
                <td>@movie.ReleaseDate</td>
            </tr>
            <tr>
                <td class="caption">Duration:</td>
                <td>@movie.Runtime min</td>
            </tr>
            <tr>
                <td class="caption">Genre:</td>
                <td>@string.Join(", ", @movie.Genres)</td>
            </tr>
            <tr>
                <td class="caption">TMDb Rating:</td>
                <td>@movie.Rating / 10</td>
            </tr>
            <tr>
                <td colspan="2">@movie.Overview</td>
            </tr>
        </tbody>
    </table>
</div>
}

@code {
    [Parameter]
    public int Id { get; set; }

    private IMovie? movie;

    protected override async Task OnInitializedAsync()
    {
        movie = await MediaServiceInstance.GetMovie(Id);
    }

    //TODO implement functionality to add and remove media-ID to and from favorites-list of user

    //Only for concept-demonstration purpose:
    private bool isInFavorites = false;
    private void SwitchFavorites()
    {
        isInFavorites = !isInFavorites;
    }
}
